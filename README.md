# ğŸ›¡ï¸ Spam News Detection - End-to-End ML Pipeline with DVC

This repository contains a complete Machine Learning (ML) pipeline for detecting spam messages using Natural Language Processing (NLP) techniques. It leverages **DVC** for data and model versioning, **dvclive** for experiment tracking, and is cloud-ready for scalable collaboration via **AWS S3** integration.

---

## ğŸ“Œ Project Overview

With the exponential rise of spam content in SMS and messaging apps, detecting and filtering spam has become vital. This project builds a robust and reproducible ML workflow from scratchâ€”starting with raw CSV data and ending with a trained, tracked, and evaluated ML model.

---

## ğŸ§  Problem Statement

Given a collection of SMS messages labeled as "ham" (not spam) or "spam", the goal is to:
- Preprocess text data (tokenize, clean, stem)
- Engineer features using `TF-IDF`
- Train multiple classification models
- Evaluate and track their performance
- Maintain reproducibility and modularity with DVC

---

## ğŸ—ƒï¸ Dataset

- ğŸ“„ `spam.csv`  
- Source: Public spam detection dataset (e.g., UCI ML repository)
- Format:  
  - `v1`: label (`ham` or `spam`)  
  - `v2`: message text  
  - Unused columns dropped during preprocessing

---

## ğŸ§° Tech Stack

| Layer             | Tool/Framework            |
|------------------|---------------------------|
| **Language**     | Python 3.x                |
| **ML Framework** | scikit-learn              |
| **NLP**          | NLTK, TF-IDF Vectorizer   |
| **Versioning**   | DVC                       |
| **Experiment Tracking** | dvclive           |
| **Cloud Storage**| AWS S3 (optional setup)   |
| **Logging & Config** | PyYAML, Logging       |
| **Data Handling**| pandas, numpy             |

---

## ğŸ§± Project Structure

```

sandeshhegde-371-spam-news-detection-complete-ml-pipeline/
â”œâ”€â”€ src/                           # All pipeline stages
â”‚   â”œâ”€â”€ data\_ingestion.py
â”‚   â”œâ”€â”€ data\_preprocessing.py
â”‚   â”œâ”€â”€ feature\_engineering.py
â”‚   â”œâ”€â”€ model\_training.py
â”‚   â””â”€â”€ model\_evaluation.py
â”œâ”€â”€ experiments/                  # Exploratory notebook + dataset
â”‚   â”œâ”€â”€ mynotebook.ipynb
â”‚   â””â”€â”€ spam.csv
â”œâ”€â”€ data/                         # Auto-generated by DVC stages
â”‚   â”œâ”€â”€ raw/
â”‚   â”œâ”€â”€ interim/
â”‚   â””â”€â”€ processed/
â”œâ”€â”€ models/                       # Trained model (model.pkl)
â”œâ”€â”€ reports/                      # Evaluation metrics
â”œâ”€â”€ dvclive/                      # dvclive experiment logs
â”‚   â”œâ”€â”€ metrics.json
â”‚   â””â”€â”€ plots/metrics/
â”œâ”€â”€ .dvc/                         # DVC internal files
â”œâ”€â”€ dvc.yaml                      # Pipeline stages definition
â”œâ”€â”€ dvc.lock                      # Pipeline snapshot
â”œâ”€â”€ params.yaml                   # Hyperparameters
â”œâ”€â”€ requirements.txt              # Python dependencies
â”œâ”€â”€ projectflow\.txt               # Manual project flow guide
â”œâ”€â”€ README.md
â””â”€â”€ LICENSE

````

---

## ğŸ”„ Pipeline Stages with DVC

Each stage is modular and version-controlled via DVC.

| Stage               | Script                     | Output Directory      |
|--------------------|----------------------------|-----------------------|
| **Data Ingestion** | `src/data_ingestion.py`    | `data/raw`            |
| **Preprocessing**  | `src/data_preprocessing.py`| `data/interim`        |
| **Feature Engg.**  | `src/feature_engineering.py`| `data/processed`     |
| **Model Training** | `src/model_training.py`    | `models/model.pkl`    |
| **Evaluation**     | `src/model_evaluation.py`  | `reports/metrics.json`|

---

## ğŸ”§ Parameters (`params.yaml`)

```yaml
data_ingestion:
  test_size: 0.15

feature_engineering:
  max_features: 40

model_building:
  n_estimators: 25
  random_state: 2
````

---

## ğŸ“ˆ Experiment Tracking

We use `dvclive` to log metrics like accuracy, precision, and recall across multiple experiments.

```bash
dvc exp run
dvc exp show
```

Logged metrics are saved in:

* `dvclive/metrics.json`
* `dvclive/plots/metrics/accuracy.tsv`, etc.

---

## ğŸ“Š Model Evaluation

Tested multiple models like:

* Logistic Regression, Naive Bayes, Random Forest
* AdaBoost, XGBoost, Extra Trees, etc.

> **Best Accuracy Achieved**: \~97.29%
> **Best Precision**: \~96.55% (Naive Bayes)

---

## â–¶ï¸ Getting Started

### 1. Clone the repo

```bash
git clone https://github.com/your-username/spam-detection-ml-pipeline.git
cd spam-detection-ml-pipeline
```

### 2. Create environment

```bash
pip install -r requirements.txt
```

### 3. Initialize DVC

```bash
dvc init
dvc repro
```

---

## ğŸ§ª To Run the Pipeline Manually

```bash
# Run each stage individually
python src/data_ingestion.py
python src/data_preprocessing.py
python src/feature_engineering.py
python src/model_training.py
python src/model_evaluation.py
```

---

## ğŸŒ©ï¸ Optional: Connect to AWS S3 (for remote storage)

```bash
dvc remote add -d myremote s3://your-s3-bucket-name
dvc remote modify myremote access_key_id <your-access-key>
dvc remote modify myremote secret_access_key <your-secret-key>
dvc push
```

---

## ğŸ§ª Run Experiments

```bash
# After changing params.yaml or model code
dvc exp run
dvc exp show
```

---

## ğŸ“œ License

This project is licensed under the [MIT License](./LICENSE) Â© 2025 Sandesh Hegde.

---

## ğŸ™Œ Acknowledgements

* UCI SMS Spam Dataset
* DVC Team & Community
* scikit-learn, NLTK, and PyYAML contributors

---

## ğŸ’¬ Contact

Created with ğŸ’» by **[Sandesh Hegde](https://github.com/sandeshhegde-371)**
Reach out via GitHub issues or drop a message!

